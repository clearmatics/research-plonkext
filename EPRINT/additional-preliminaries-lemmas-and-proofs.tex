\section{Additional preliminaries}

\subsection{SNARKY Signatures Construction}\label{sec:SoKconstruction}

We will recall the contrustion of 
a signature of knowledge scheme for messages in $\{0, 1\}^*$
from an SE-SNARK as shown in \cite{C:GroMal17}. 
 
Consider a target collision-resistant hash function also known as universal oneway hash function $H:\{0, 1\}^{\ell_k} \times \{0, 1\}^* \to \{0, 1\}^{\ell_h}$ with $\ell_K, \ell_h$ polynomials in the security parameter $\secpar$. 

The target collision-resistance of $H$ requires that for any $\ppt$ adversary $\adv$ : 
 
	\[  \condprob{
	m_0 \gets \adv(1^\secpar); K \gets \{0, 1\}^{\ell_K}; m_1 \gets \adv(K)
}{
	m_0 \neq m_1 ~\land  ~H_K(m_0)=H_K(m_1)
} \leq \negl.
	\]
	
For any given relation $\REL'$, we consider the  following relation $\REL$:
 	\[\REL= \{((K,h,\inp),\wit) : K\in  \{0, 1\}^{\ell_K} ~\land ~h \in  \{0, 1\}^{\ell_h} ~\land ~(\inp, \wit) \in \REL'\}.
 	\]
 	
Let $\RELGEN(\secparam)$ be the relation generator that runs $\REL' \gets \RELGEN'(\secparam)$ and returns $\REL$ defined as above. 
Let $H$ be a target collision-resistant hash function and let $\ps = (\kgen, \prover, \verifier, \simulator)$ be a SE-NIZK argument for $\RELGEN$. 
We build a signature of knowledge  $\SoK$ for $\RELGEN'$ that works as follows: 

\begin{description}
    \item[$\signsetup(1^\secpar, \REL') \rightarrow  \param$:]
 Run $(\srs,\rho) \leftarrow \kgen(\REL)$. 
 Return $ \param = \srs$.

    \item[$\sign(\mesage, \inp, \wit)  \rightarrow \signature$:]
Sample $K \gets \{0, 1\}^{\ell_K}$.  Compute
$\zkproof \gets  \prover(\srs, (K, H_K(\mesage), \inp), \wit) $.
Return $\signature = (K, \zkproof)$.

    \item[$\verify(\mesage, \inp, \signature) \rightarrow b$:]
Parse $\signature = (K, \zkproof)$.
Return $b \gets \verifier(\srs, (K, H_K(\mesage), \inp), \zkproof)$.
	
    \item[$\simsetup(\REL') \rightarrow (\param, \td)$:]
  Run   $(\srs,\rho) \leftarrow \kgen(\REL)$. 
 Return $( \param = \srs,  \td = \rho)$.

    	
   \item[$\simsign(\td, \mesage, \inp) \rightarrow \signature'$:]
   Sample $K \gets \{0, 1\}^{\ell_K}$.  Compute
$\zkproof \gets \simulator(\srs, \rho, (K, H_K(\mesage), \inp)) $.
Return $\signature' = (K, \zkproof)$.

\end{description} 


\begin{theorem}[Signature of Knowledge] 
  \label{thm:SoK}
If $H:\{0, 1\}^{\ell_k} \times \{0, 1\}^* \to \{0, 1\}^{\ell_h}$ is a target collision-resistant hash function 
and $\ps = (\kgen, \prover, \verifier, \simulator)$ be is a SE-NIZK for $\RELGEN(\secparam)$, then the scheme
 $\SoK = (\signsetup,  \sign, \allowbreak \verify,  \simsetup, \simsign)$ above is a signature of knowledge for $\RELGEN'(\secparam)$ for  the message space $\{0, 1\}^*$.
\end{theorem}
 The proof can be found in 
 \cite{C:GroMal17}.
	
\subsection{Security of uber assumption}
\label{sec:uber-assumption-security-proof}.
We show security of our version of the uber assumption using the generic group model as
introduced by Shoup \cite{EC:Shoup97} where all group elements are represented by random binary
strings of length $\secpar$. That is, there are random encodings $\xi_1, \xi_2, \xi_T$ which
are injective functions from $\ZZ_p^+$ to $\bin^{\secpar}$. We write
$\GRP_i = \smallset{\xi_i(x) \mid x \in \ZZ_p^+}$, for $i \in \smallset{1, 2, T}$. For the sake
of clarity we denote by $\xi_{i, j}$ the $j$-th encoding in group $\GRP_i$.

Let
$\p{P}_i = \smallset{p_1, \ldots, p_{\tau_i}} \subset \FF_p[X_1, \ldots, X_n]$,
for $i \in \smallset{1, 2, T}, \tau_i, n \in \NN$, be sets of multivariate
polynomials. Denote by $\p{P}_i(x_1, \ldots, x_n)$ a set of evaluations of
polynomials in $\p{P_i}$ at $(x_1, \ldots, x_n)$. Denote by
$L_i = \smallset{(p_j, \xi_{i, j}) \mid j \leq \tau_i}$.

Let $\adv$ be an algorithm that is given encodings $\xi_{i, j_i}$ of polynomials
in $\p{P}_i$ for $i \in \smallset{1, 2, T}, j_i = \tau_i$. There is an oracle $\oracleo$
that allows to perform $\adv$ the following queries:
\begin{description}
\item[Group operations in $\GRP_1, \GRP_2, \GRP_T$:] On input
  $(\xi_{i, j}, \xi_{i, j'}, i, op)$, $j, j' \leq \tau_i$,
  $op \in \smallset{\msg{add}, \msg{sub}}$, $\oracleo$ sets $\tau'_i \gets \tau_i + 1$,
  computes
  $p_{i, \tau'_i} = p_{i, j}(x_1, \ldots, x_n) \pm p_{i, j'}(x_1, \ldots, x_n)$
  respectively to $op$. If there is an element  $p_{i, k} \in L_i$ such 
  that $p_{i, k} = p_{\tau'_i}$, then the oracle returns encoding of $p_{i,
    k}$. Otherwise it sets the encoding $\xi_{i, \tau'_i}$ to a new unused
  random string, adds $(p_{i, \tau'_i}, \xi_{i, \tau'_i})$ to $L_i$, and returns
  $\xi_{i, \tau'_i}$.
\item[Bilinear pairing:] On input $(\xi_{1, j}, \xi_{2, j'})$ the oracle sets
  $\tau' \gets \tau_T + 1$ and computes
  $r_{\tau'} \gets p_{i, j}(x_1, \ldots, x_n) \cdot p_{i, j'}(x_1, \ldots,
  x_n)$. If $r_{\tau'} \in L_T$ then return encoding found in the list $L_T$,
  else pick a new unused random string and set $\xi_{T, \tau'}$ to it. Return
  the encoding to the algorithm.
\end{description}

Given that, we are ready to show security of our variant of the Boneh et
al.~uber assumption. The proof goes similarly to the original proof given in
\cite{EC:BonBoyGoh05} with minor differences.

\begin{theorem}[Security of the uber assumption]
  \label{thm:uber_assumption}
  Let $\p{P}_i \in \FF_p[X_1, \ldots, X_n]^{m_i}$, for
  $i \in \smallset{1, 2, T}$ be $\tau_i$ tuples of $n$-variate polynomials over
  $\FF_p$ and let $\p{F} \in \FF_p[X_1, \ldots, X_n]^m$. Let
  $\xi_0, \xi_1, \xi_T$, $\GRP_1, \GRP_2, \GRP_T$ be as defined above. If
  polynomials $f \in \p{F}$ are pair-wise independent and are independent of
  $\p{P}_1, \p{P}_2, \p{P}_T$, then for any $\adv$ that makes up to $q$ queries to the
  GGM oracle holds:
  \begin{equation*}
    \begin{split}
     \left|\,
    \Pr\left[
    \adv\left(
      \begin{aligned}
        \xi_1(\p{P}_1(x_1, \ldots, x_n)), \\
        \xi_2(\p{P}_2(x_1, \ldots, x_n)), \\
        \xi_T(\p{P}_T(x_1, \ldots, x_n)), \\
        \xi_{1}(\p{F}_0), \xi_{1}(\p{F}_1)
      \end{aligned}
    \right) = b
    \, \left|\,
      \begin{aligned}
        x_1, \ldots, x_n, y_1, \ldots, y_m \sample \FF_p,\\
        b \sample \bin, \\
        \p{F}_b \gets \p{F}(x_1, \ldots, x_n),\\
        \p{F}_{1 - b} \gets (y_1, \ldots, y_m)
      \end{aligned}
    \right.  \right] - \frac{1}{2} \, \right| \\
     \leq \frac{d(q + m_1 + m_2 + m_T +
      m)^2 }{2p}
    \end{split}
  \end{equation*}
\end{theorem}
\begin{proof}
  Let $\cdv$ be a challenger that plays with $\adv$ in the following
  game. $\cdv$ maintains three lists
  \[
    L_i = \smallset{(p_j, \xi_{i, j}) \mid j \in \range{1}{\tau_i}},
  \]
  for $i \in \smallset{1, 2, T}$. Invariant $\tau$ states that
  $\tau_1 + \tau_2 + \tau_T = \tau + m_1 + m_2 + m$.

  Challenger $\cdv$ answers $\adv$'s oracle queries. However, it does it a bit
  differently that the oracle $\oracleo$ would:
  \begin{description}
  \item[Group operations in $\GRP_1, \GRP_2, \GRP_T$:] On input
    $(\xi_{i, j}, \xi_{i, j'}, i, op)$, $j, j' \leq \tau_i$,
    $op \in \smallset{\msg{add}, \msg{sub}}$, $\cdv$ sets
    $\tau' \gets \tau_i + 1$, computes
    $p_{i, \tau'}(X_1, \ldots, X_n) = p_{i, j}(X_1, \ldots, X_n) \pm p_{i,
      j'}(X_1, \ldots, X_n)$ respectively to $op$. If there is a polynomial
    $p_{i, k}(X_1, \ldots, X_n) \in L_i$ such that
    $p_{i, k}(X_1, \ldots, X_n) = p_{\tau'}(X_1, \ldots, X_n)$, then the
    challenger returns encoding of $p_{i, k}$. Otherwise it sets the encoding
    $\xi_{i, \tau'}$ to a new unused random string, adds
    $(p_{i, \tau'}, \xi_{i, \tau'})$ to $L_i$, and returns $\xi_{i, \tau'}$.
  \item[Bilinear pairing:] On input $(\xi_{1, j}, \xi_{2, j'})$ the challenger
    sets $\tau' \gets \tau_T + 1$ and computes
    $r_{\tau'}(X_1, \ldots, X_n) \gets p_{i, j}(X_1, \ldots, X_n) \cdot p_{i,
      j'}(X_1, \ldots, X_n)$. If $r_{\tau'}(X_1, \ldots, X_n) \in L_T$, $\cdv$
    returns encoding found in the list $L_T$. Else it picks a new unused random
    string and set $\xi_{T, \tau'}$ to it. Finally it returns the encoding to
    the algorithm.
\end{description}
  
After at most $q$ queries to the oracle, the adversary returns a bit $b'$. At
that point the challenger $\cdv$ chooses randomly $x_1, \ldots, x_n, y_1 \ldots, y_m$,
random bit $b$, and sets $X_i = x_i$, for $i \in \range{1}{n}$, and $Y_i = y_i$,
for $i \in \range{1}{m}$; furthermore, $\p{F}_b \gets \p{F}(x_1, \ldots, x_n)$
and $\p{F}_{1 - b} \gets (y_1, \ldots, y_m)$. Note that $\cdv$ simulates
perfectly unless the chosen values $x_1, \ldots, x_n, y_1, \ldots, y_m$ result
in equalities between polynomial evaluations that are not equalities between the
polynomials. That is, the simulation is perfect unless for some $i, j, j'$ holds
\[
  p_{i, j}(x_1, \ldots, x_n) - p_{i, j'}(x_1, \ldots, x_n) = 0,
  \]
  for $p_{i, j}(X_1, \ldots, X_n) \neq p_{i, j'}(X_1, \ldots, X_n)$.  Denote by
  $\bad$ an event that at least one of the three conditions holds. When $\bad$
  happens, the answer $\cdv$ gives to $\adv$ differs from an answer that a real
  oracle would give. We bound the probability that $\bad$ occurs in two steps.

  First we set $\p{F}_b = \p{F}(X_1, \ldots, X_n)$. Note that symbolic
  substitutions do not introduce any new equalities in $\GRP_1$. That is, if for
  all $j, j'$ holds $p_{1, j} \neq p_{1, j'}$, then $p_{1, j} \neq p_{1, j'}$
  even after setting $\p{F}_b = \p{F}(X_1, \ldots, X_n)$. This follows since all
  polynomials in $\p{F}$ are pairwise independent and $\p{F}$ independent on
  $\p{P}_1, \p{P}_2, \p{P}_T$. Indeed, $p_{1, j} - p_{1, j'}$ is a polynomial of
  the form
  \[
    \sum_{j = 1}^{m_1}a_j p_{1, j} + \sum_{j = 1}^{m} b_j f_j (X_1, \ldots, X_n),
  \]
  for some constants $a_j, b_j$. If the polynomial is non-zero, but setting
  $\p{F}_b = \p{F}(X_1, \ldots, X_n)$ makes this polynomial vanish, then some
  $f_k$ must be dependent on some $\p{P}_1, \p{F} \setminus \smallset{f_k}$.

  Now we set $X_1 \ldots, X_n, \p{F}_{1 - b}$ and bound probability that for
  some $i$ and $j, j'$ holds
  $(p_{i, j}(x_1, \ldots, x_n) - p_{i, j'}(x_1, \ldots, x_n) = 0$ for
  $p_{i, j} \neq p_{i, j'}$. By the construction, the maximum total degree of
  these polynomials is
  $d = \max(d_{\p{P}_1}+ d_{\p{P}_2}, d_{\p{P}_T}, d_{\p{F}})$, where $d_f$ is
  the total degree of some polynomial $f$ and for a set of polynomials
  $F = \smallset{f_1, \ldots, f_k}$, we write
  $d_F = \smallset{d_{f_1}, \ldots, d_{f_k}}$. Thus, for a given $j, j'$ probability that a random assignment to
  $X_1, \ldots, X_n, Y_1, \ldots, Y_n$ is a root of $p_{i, j} - p_{i, j'}$ is,
  by the Schwartz-Zippel lemma, bounded by $\infrac{d}{p}$, which is
  negligible. There is at most $2 \cdot {q + m_0 + m_1 + m  \choose 2}$ such
  pairs $p_{i, j}, p_{i, j'}$ we have that
  \[
    \prob{\bad} \leq  {q + m_0 + m_1 + m  \choose 2} \cdot \frac{2d}{p} \leq (q
    + m_0 + m_1 + m)^2 \frac{d}{p}.
  \]

  As noted, if $\bad$ does not occur then the simulation is perfect. Also the
  bit $b$ has been chosen independently on the $\adv$'s view, thus $\condprob{b
    = b'}{\neg \bad} = \infrac{1}{2}$. Hence,
  \[
    \begin{aligned}
      \prob{b = b'} & \leq \condprob{b = b'}{\neg \bad}(1 - \prob{\bad}) + \prob{\bad} =
      \frac{1}{2} + \frac{\prob{\bad}}{2} \\
      \prob{b = b'} & \geq \condprob{b = b'}{\neq \bad}(1 - \prob{\bad}) =
      \frac{1}{2} - \frac{\prob{\bad}}{2}.
    \end{aligned}
  \]
  Finally,
  \[
    \abs{\Pr[b = b'] - \frac{1}{2}} \leq \prob{\bad}/2 \leq (q
    + m_0 + m_1 + m)^2 \frac{d}{2p}
  \]
  as required.
\end{proof}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
